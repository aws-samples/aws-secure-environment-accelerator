module.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t,n){t.SUCCESS="SUCCESS",t.FAILED="FAILED",t.send=function(e,t,r,o,s){var a=JSON.stringify({Status:r,Reason:"See the details in CloudWatch Log Stream: "+t.logStreamName,PhysicalResourceId:s||t.logStreamName,StackId:e.StackId,RequestId:e.RequestId,LogicalResourceId:e.LogicalResourceId,Data:o});console.log("Response body:\n",a);var i=n(2),u=n(3).parse(e.ResponseURL),c={hostname:u.hostname,port:443,path:u.path,method:"PUT",headers:{"content-type":"","content-length":a.length}},l=i.request(c,(function(e){console.log("Status code: "+e.statusCode),console.log("Status message: "+e.statusMessage),t.done()}));l.on("error",(function(e){console.log("send(..) failed executing https.request(..): "+e),t.done()})),l.write(a),l.end()}},function(e,t){e.exports=require("aws-sdk")},function(e,t){e.exports=require("https")},function(e,t){e.exports=require("url")},function(e,t,n){"use strict";n.r(t),n.d(t,"imageFinder",(function(){return s}));var r=n(1),o=n(0);const s=async(e,t)=>{console.log("Finding image ID..."),console.log(JSON.stringify(e,null,2));if("Delete"===e.RequestType)return console.log("No operation to perform Delete Stack"),a(e,t,o.SUCCESS,{},"ImageIdFinder");try{const n=new r.EC2,s=(await n.describeImages(function(e){const{imageOwner:t,imageName:n,imageVersion:r}=e,o=[];t&&o.push(t);const s=[];n&&s.push({Name:"Name",Values:[n]});r&&s.push({Name:"Name",Values:[r]});return{Owners:o,Filters:s}}({imageOwner:e.ResourceProperties.ImageOwner,imageName:e.ResourceProperties.ImageName,imageVersion:e.ResourceProperties.ImageVersion})).promise()).Images;if(!s||0===s.length)throw new Error("Unable to find image");s.sort((e,t)=>t.CreationDate.localeCompare(e.CreationDate));const i={ImageID:s[0].ImageId};return a(e,t,o.SUCCESS,i,"ImageIdFinder")}catch(n){return console.error(n),a(e,t,o.FAILED,{status:"FAILED",statusReason:JSON.stringify(n)},"ImageIdFinder")}};function a(e,t,n,r,s){return new Promise(a=>{t.done=a,Object(o.send)(e,t,n,r,s)})}}]);