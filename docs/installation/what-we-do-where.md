# AWS Secure Environment Accelerator Deployment Capabilities

| TASK                                                                                                   | Accelerator - What happens, WHERE, under what condition, on each state machine execution                                                                                                                                      |
| ------------------------------------------------------------------------------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **_ Creates AWS Account _**                                                                            |                                                                                                                                                                                                                               |
| - Create mandatory accounts (accounts other accounts are dependent on)                                 | organization management (root) account, global scope                                                                                                                                                                          |
| - Create workload accounts                                                                             | organization management (root) account, global scope                                                                                                                                                                          |
| - AWS Organizations Account and OU activities (OU or account rename, move account between OU's, etc.)  | organization management (root) account, global scope                                                                                                                                                                          |
| - Applies a Deny All SCP on any newly created account(s) until successfully guardrailed                | organization management (root) account, new account scope (failure to apply guardrails fails the Accelerator and leaves account blocked, until remediated)                                                                    |
| - Allows bulk parallel account creation, configuration and guardrail application                       | creates, guardrails and configures new accounts and regions in parallel per defined personas, organization management (root) account                                                                                          |
| - Supports using AWS Organizations to create/rename/move accounts                                      | creates, guardrails and configures new accounts and regions in parallel per defined personas, organization management (root) account                                                                                          |
| - Performs 'account warming' to establish initial limits, when required                                | state Machine region only, defined accounts (per region potential)                                                                                                                                                            |
| - Checks limit increases, when required (complies with initial limits until increased)                 | per account, per region (supported limits only)                                                                                                                                                                               |
| - Automatically submits limit increases, when required                                                 | state Machine region only, defined accounts (per region potential)                                                                                                                                                            |
| **_ Creates Networking _**                                                                             |                                                                                                                                                                                                                               |
| - Transit Gateways and TGW route tables incl static routes                                             | in the defined region(s), defined account(s)                                                                                                                                                                                  |
| - Centralized and/or Local (bespoke) VPC's                                                             | in the defined region(s), defined account(s)                                                                                                                                                                                  |
| - Subnets, Route tables, NACLs, Security groups, NATGWs, IGWs, VGWs, CGWs                              | part of any VPC, in the defined region(s), defined account(s) - allows detailed CIDR allocation, cross-account security group referencing                                                                                     |
| - Deletes default VPC's (worldwide)                                                                    | in all regions, in all accounts, can disable regions (all accounts or specific account)                                                                                                                                       |
| - VPC Endpoints (Gateway and Interface)                                                                | part of any VPC, in the defined region(s), defined account(s)                                                                                                                                                                 |
| - use central endpoints (R53 zones shared and attached to additional local or remote VPC's)            | configures regional central endpoints (only one 'central' VPC per region)                                                                                                                                                     |
| - Route 53 Private and Public Zones                                                                    | in the defined account(s), defined region(s), defined VPC(s), global scope                                                                                                                                                    |
| - Resolver Rules and Resolver (inbound/outbound) Endpoints                                             | part of a specific VPC(s), in the defined region(s), defined account(s) (i.e. per region possible)                                                                                                                            |
| ...including MAD R53 DNS resolver rule creation                                                        | created in same region as MAD only, shared to same region VPC's when use-central-endpoints set                                                                                                                                |
| - R53 VPC Endpoint Overloaded Zones                                                                    | same region(s), same account(s) as the endpoint and VPC(s)                                                                                                                                                                    |
| **_ Cross-Account Object Sharing _**                                                                   |                                                                                                                                                                                                                               |
| - VPC and Subnet sharing, including account level retagging (Per account security group 'replication') | VPC's are shared to accounts within the SAME REGION as the source VPC only<br>An OU could have additional VPC's defined for additional regions and would be shared to the appropriate accounts in the same additional regions |
| - VPC attachments and peering (local and cross-account)                                                | in the defined region, no cross-region attachments or peering supported                                                                                                                                                       |
| - Managed Active Directory sharing                                                                     | state machine region only (consider same region as the MAD only)                                                                                                                                                              |
| - Automated TGW inter-region peering                                                                   | cross-region, cross-account or same-account                                                                                                                                                                                   |
| - Shares SSM remediation documents                                                                     | from defined account, to defined OU's, defined regions                                                                                                                                                                        |
| **_ Zone sharing and VPC associations _**                                                              |                                                                                                                                                                                                                               |
| - Public Hosted Zones                                                                                  | no sharing, no association required (any account, any VPC, any region)                                                                                                                                                        |
| - Private Hosted Zones - i.e. Cloud DNS domains                                                        | associate worldwide, all VPC with use-central-endpoints                                                                                                                                                                       |
| - Endpoint Private Hosted Zones                                                                        | associate within region, for all VPC use-central-endpoints (including cross-account)                                                                                                                                          |
| - On-premise resolver rules                                                                            | associate within region, for all VPC use-central-endpoints                                                                                                                                                                    |
| - MAD resolver rule association                                                                        | same region as the MAD resolver only, assoc. w/all VPC use-central-endpoints                                                                                                                                                  |
| **_ Identity _**                                                                                       |                                                                                                                                                                                                                               |
| - Creates Directory services (Managed Active Directory and Active Directory Connectors)                | in a specific VPC, in the defined region, defined account - only 1 per account, therfore can't have a second region in the same account                                                                                       |
| - Creates Windows admin bastion host auto-scaling group                                                | once per above MAD (once per account), same region as MAD                                                                                                                                                                     |
| - Set Windows domain password policies (initial installation only)                                     | once per above MAD (once per account), same region as MAD                                                                                                                                                                     |
| - Set IAM account password policies                                                                    | once per account, global scope                                                                                                                                                                                                |
| - Creates Windows domain users and groups (initial installation only)                                  | once per above MAD (once per account), same region as MAD                                                                                                                                                                     |
| - Creates IAM Policies, Roles, Users, and Groups                                                       | once per account, global scope                                                                                                                                                                                                |
| **_ Cloud Security Services _**                                                                        |                                                                                                                                                                                                                               |
| - Enables and configs the following AWS services, worldwide w/central specified admin account:         | (each service can have specified regions disabled)                                                                                                                                                                            |
| - Guardduty w/S3 protection                                                                            | enabled all regions, all accounts, admin account per region                                                                                                                                                                   |
| - Security Hub (Enables specified security standards, and disables specified individual controls)      | enabled all regions, all accounts, admin account per region                                                                                                                                                                   |
| - Firewall Manager                                                                                     | enabled once per account (global scope), single admin account                                                                                                                                                                 |
| - CloudTrail w/Insights and S3 data plane logging                                                      | enabled all regions (using Organization trail, stored in Organization Management account)                                                                                                                                     |
| - Config Recorders/Aggregator                                                                          | enabled all regions, all regions include global events, aggregator set to specified region in Organization Management account                                                                                                 |
| - Macie                                                                                                | enabled all regions, admin account per region                                                                                                                                                                                 |
| - IAM Access Analyzer                                                                                  | enabled once per account (global scope), single admin account                                                                                                                                                                 |
| - CloudWatch access from central specified admin account                                               | enabled once per account (global scope), Two admin accounts (Ops & Security)                                                                                                                                                  |
| - Deploys customer provided SSM remediation documents (two provided out-of-box today)                  | customized per OU, defined regions                                                                                                                                                                                            |
| - Deploys AWS Config rules including Conformance packs                                                 | customized per OU, all regions, integrated w/SSM remediation, when desired                                                                                                                                                    |
| **_ Other Security Capabilities _**                                                                    |                                                                                                                                                                                                                               |
| - Creates, deploys and applies Service Control Policies                                                | at the top OU level only, sub-ou's managed directly through AWS Organizations                                                                                                                                                 |
| - Creates Customer Managed KMS Keys w/rotation (SSM, EBS, S3)                                          | SSM and EBS keys are created if a VPC exists in the region, S3 if we need an Accel bucket in the region, per account                                                                                                          |
| - Enables account level default EBS encryption                                                         | set if a VPC exists in the region, per account                                                                                                                                                                                |
| - S3 Block Public Access                                                                               | once per account, global scope                                                                                                                                                                                                |
| - Configures Systems Manager Session Manager w/KMS encryption and centralized logging                  | set if a VPC exists in the region, per account                                                                                                                                                                                |
| - Creates and configures AWS budgets (customizable per OU and per account)                             | once per account, global scope                                                                                                                                                                                                |
| - Imports or requests certificates into AWS Certificate Manager                                        | State Machine region only (per region potential, required for alb deployments)                                                                                                                                                |
| - Deploys both perimeter and account level ALB's w/Lambda health checks, certs & TLS policies          | State Machine region only (per region potential)                                                                                                                                                                              |
| - Deploys & configures 3rd party firewall clusters and management instances                            | in the defined region(s), defined account(s)                                                                                                                                                                                  |
| - Configuration is fully managed and maintained in AWS CodeCommit - full config change history         | organization management (root) account                                                                                                                                                                                        |
| ...breaking configuration changes block Accelerator execution                                          | Indempotent - extensive error handling and failure cleanup - Accelerator can be stopped, started, and rerun without implication                                                                                               |
| **_ Centralized Logging _**                                                                            |                                                                                                                                                                                                                               |
| - Deploys an rsyslog auto-scaling cluster behind an NLB, all syslogs forwarded to CWL                  | State Machine region only (per region potential)                                                                                                                                                                              |
| - Centralizes logging to a single centralized S3 bucket (enables, configures and centralizes) incl:    | Sets S3 ownership flag                                                                                                                                                                                                        |
| - VPC Flow logs (w/Enhanced metadata fields and optional CWL destination)                              | part of a specific VPC, in the defined region, defined account (to local account bucket in state machine region, replicated to log-archive primary region)                                                                    |
| - Organizational Cost and Usage Reports                                                                | once per organization, global scope (to local account bucket in state machine region, replicated to log-archive primary region)                                                                                               |
| - CloudTrail Logs including S3 Data Plane Logs (also sent to CWL)                                      | directly back to log-archive, specified primary region                                                                                                                                                                        |
| - All CloudWatch Logs (includes rsyslog logs) (and setting Log group retentions)                       | State machine region, plus configured regions                                                                                                                                                                                 |
| - Config History and Snapshots                                                                         | directly back to log-archive account specified primary region                                                                                                                                                                 |
| - Route 53 Public Zone Logs, DNS Resolver Query Logs                                                   | to CloudWatch Logs in us-east-1 (which are sent to S3)                                                                                                                                                                        |
| - GuardDuty Findings                                                                                   | directly back to log-archive, specified primary region                                                                                                                                                                        |
| - Macie Discovery results                                                                              | directly back to security, specified primary region, replicated to log-archive                                                                                                                                                |
| - ALB Logs                                                                                             | State Machine region only (same as ALB deployment)                                                                                                                                                                            |
| - SSM Session Logs                                                                                     | All regions currently send back to central region, log-archive account                                                                                                                                                        |
| **_ Extensability _**                                                                                  |                                                                                                                                                                                                                               |
| - Populate Parameter Store with Accelerator deployed objects                                           | every account, defined regions (all account ELB's are populated in specified accounts, i.e. perimeter)                                                                                                                        |
| - Every Accelerator execution outputs the execution status to a SNS topic                              | allows 3rd party framework to execute after every Accelerator execution by hooking to SNS topic                                                                                                                               |
| ...subscribed to a customer defined email address                                                      | ...or hooking to the email alert                                                                                                                                                                                              |
| - automated cross-account role creation with read-only access to log-archive account (for SIEM access) | defined account                                                                                                                                                                                                               |
| **_ Alerting _**                                                                                       |                                                                                                                                                                                                                               |
| - Deploys High, Medium, Low, Ignore priority SNS topics                                                | in the defined account, org accessible regional topics, each region subsribed to a single defined central region with email alerting                                                                                          |
| - Deploys customer defined CloudWatch Log Metrics and Alarms                                           | in the organization management (root) account, as this is where the Org CloudTrail exists (could extend to per account in future)                                                                                             |
---

## General
- all of the above items are fully customizable by the customer without changing a single line of code
- while many items are deployed globably by default, single region only deployments are possible
- customer can enable/disable features, or change the configuration of each feature in the config file
- customers can evolve their configurations over time, as they evolve and as their requirements change 

## Region support
- Most AWS regions are supported.  Lack of availability of CodeBuild, CodeCommit, or AWS Organizations in the Accelerator primary or installation region will prevent installation directly in that region. In these cases, customers can select a different installation region and the Accelerator can remotely deploy configurations and guardrails to that unsupported installation region.
- Prior to v1.2.5, we utilized a single StackSet, which blocked several additional installation regions. The Accelerator no longer leverages any StackSets, unblocking installing directly in several additional regions.
- As most features can be toggled on/off (per region), we expect most regions should be supportable as a primary (or installation) region, and when not due to one of the 3 above services, it should be supported as a managed (or secondary) region.

## ToDo: Add to above table (supported today)

- future feature

---

[...Return to Accelerator Table of Contents](./index.md)
